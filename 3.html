<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600" width="100%" height="100%">
    <!-- 样式定义 -->
    <style>
        .shelf { fill: #8B4513; stroke: #6d350f; stroke-width: 2; }
        .shelf-board { fill: #A0522D; stroke: #6d350f; stroke-width: 1; }
        .box-closed { fill: #4682B4; stroke: #36648B; stroke-width: 2; cursor: pointer; }
        .box-opened { fill: #20B2AA; stroke: #16827A; stroke-width: 2; cursor: pointer; }
        .box-text { font-family: Arial, sans-serif; font-size: 12px; fill: white; text-anchor: middle; pointer-events: none; }
        .empty-space { fill: #D2B48C; stroke: #A0522D; stroke-width: 1; stroke-dasharray: 5,3; }
        .button { fill: #4CAF50; stroke: #388E3C; stroke-width: 2; cursor: pointer; }
        .button-text { font-family: Arial, sans-serif; font-size: 14px; fill: white; text-anchor: middle; pointer-events: none; }
        .modal { fill: rgba(255,255,255,0.95); stroke: #333; stroke-width: 2; rx: 5; ry: 5; }
        .modal-title { font-family: Arial, sans-serif; font-size: 18px; font-weight: bold; fill: #333; }
        .modal-content { font-family: Arial, sans-serif; font-size: 14px; fill: #666; }
        .close-button { fill: #f44336; stroke: #d32f2f; stroke-width: 1; cursor: pointer; }
        .close-text { font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; fill: white; text-anchor: middle; pointer-events: none; }
        .hidden { display: none; }
    </style>

    <!-- 动画定义 -->
    <animate id="boxBounce" attributeName="transform" type="translate" values="0,0; 0,-5; 0,0" dur="0.5s" repeatCount="indefinite" begin="indefinite" />

    <!-- 货架和盒子将通过脚本动态生成 -->
    <g id="shelfContainer"></g>

    <!-- 动画按钮 -->
    <rect id="animateButton" class="button" x="650" y="500" width="100" height="40" rx="5" ry="5">
        <title>点击触发盒子动画</title>
    </rect>
    <text class="button-text" x="700" y="525">动画</text>

    <!-- 弹窗 (默认隐藏) -->
    <g id="modal" class="hidden">
        <rect class="modal" x="200" y="150" width="400" height="300" />
        <text id="modalTitle" class="modal-title" x="400" y="180"></text>
        <text id="modalContent" class="modal-content" x="250" y="220"></text>
        <image id="modalImage" x="250" y="250" width="300" height="150" />
        <rect id="closeButton" class="close-button" x="550" y="160" width="30" height="30" rx="3" ry="3">
            <title>关闭</title>
        </rect>
        <text class="close-text" x="565" y="180">×</text>
    </g>

    <script type="text/javascript"><![CDATA[
    // 示例JSON数据
    const shelfData = {
        "第一层": {
            "第一个": {"status": true, "is_show": true, "str": "盒子名称1", "status_str": "未打开可使用", "title": "二级页面标题1", "content": "这是第一个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=1"},
            "第二个": {"status": false, "is_show": true, "str": "盒子名称2", "status_str": "已打开", "title": "二级页面标题2", "content": "这是第二个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=2"},
            "第三个": {"status": true, "is_show": false, "str": "盒子名称3", "status_str": "未打开可使用", "title": "二级页面标题3", "content": "这是第三个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=3"},
            "第四个": {"status": false, "is_show": true, "str": "盒子名称4", "status_str": "已打开", "title": "二级页面标题4", "content": "这是第四个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=4"},
            "第五个": {"status": true, "is_show": true, "str": "盒子名称5", "status_str": "未打开可使用", "title": "二级页面标题5", "content": "这是第五个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=5"}
        },
        "第二层": {
            "第一个": {"status": true, "is_show": true, "str": "盒子名称6", "status_str": "未打开可使用", "title": "二级页面标题6", "content": "这是第六个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=6"},
            "第二个": {"status": false, "is_show": true, "str": "盒子名称7", "status_str": "已打开", "title": "二级页面标题7", "content": "这是第七个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=7"},
            "第三个": {"status": true, "is_show": true, "str": "盒子名称8", "status_str": "未打开可使用", "title": "二级页面标题8", "content": "这是第八个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=8"},
            "第四个": {"status": false, "is_show": false, "str": "盒子名称9", "status_str": "已打开", "title": "二级页面标题9", "content": "这是第九个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=9"},
            "第五个": {"status": true, "is_show": true, "str": "盒子名称10", "status_str": "未打开可使用", "title": "二级页面标题10", "content": "这是第十个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=10"}
        },
        "第三层": {
            "第一个": {"status": true, "is_show": true, "str": "盒子名称11", "status_str": "未打开可使用", "title": "二级页面标题11", "content": "这是第十一个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=11"},
            "第二个": {"status": false, "is_show": true, "str": "盒子名称12", "status_str": "已打开", "title": "二级页面标题12", "content": "这是第十二个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=12"},
            "第三个": {"status": true, "is_show": true, "str": "盒子名称13", "status_str": "未打开可使用", "title": "二级页面标题13", "content": "这是第十三个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=13"},
            "第四个": {"status": false, "is_show": true, "str": "盒子名称14", "status_str": "已打开", "title": "二级页面标题14", "content": "这是第十四个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=14"},
            "第五个": {"status": true, "is_show": false, "str": "盒子名称15", "status_str": "未打开可使用", "title": "二级页面标题15", "content": "这是第十五个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=15"}
        },
        "第四层": {
            "第一个": {"status": true, "is_show": true, "str": "盒子名称16", "status_str": "未打开可使用", "title": "二级页面标题16", "content": "这是第十六个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=16"},
            "第二个": {"status": false, "is_show": false, "str": "盒子名称17", "status_str": "已打开", "title": "二级页面标题17", "content": "这是第十七个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=17"},
            "第三个": {"status": true, "is_show": true, "str": "盒子名称18", "status_str": "未打开可使用", "title": "二级页面标题18", "content": "这是第十八个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=18"},
            "第四个": {"status": false, "is_show": true, "str": "盒子名称19", "status_str": "已打开", "title": "二级页面标题19", "content": "这是第十九个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=19"},
            "第五个": {"status": true, "is_show": true, "str": "盒子名称20", "status_str": "未打开可使用", "title": "二级页面标题20", "content": "这是第二十个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=20"}
        },
        "第五层": {
            "第一个": {"status": true, "is_show": false, "str": "盒子名称21", "status_str": "未打开可使用", "title": "二级页面标题21", "content": "这是第二十一个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=21"},
            "第二个": {"status": false, "is_show": true, "str": "盒子名称22", "status_str": "已打开", "title": "二级页面标题22", "content": "这是第二十二个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=22"},
            "第三个": {"status": true, "is_show": true, "str": "盒子名称23", "status_str": "未打开可使用", "title": "二级页面标题23", "content": "这是第二十三个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=23"},
            "第四个": {"status": false, "is_show": true, "str": "盒子名称24", "status_str": "已打开", "title": "二级页面标题24", "content": "这是第二十四个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=24"},
            "第五个": {"status": true, "is_show": true, "str": "盒子名称25", "status_str": "未打开可使用", "title": "二级页面标题25", "content": "这是第二十五个盒子的详细内容，包含了该盲盒的具体信息和说明。", "img": "https://picsum.photos/300/150?random=25"}
        }
    };

    // 渲染货架和盒子
    function renderShelf() {
        const shelfContainer = document.getElementById('shelfContainer');
        const layerNames = Object.keys(shelfData);
        const shelfWidth = 700;
        const shelfHeight = 100;
        const startX = 50;
        const startY = 50;
        const boxWidth = 100;
        const boxHeight = 80;
        const boxMargin = 20;

        // 绘制货架
        layerNames.forEach((layerName, layerIndex) => {
            const layerY = startY + layerIndex * shelfHeight;

            // 绘制货架层
            const shelf = document.createElementNS("http://www.w3.org/2000/svg", "rect");
            shelf.setAttribute("class", "shelf");
            shelf.setAttribute("x", startX);
            shelf.setAttribute("y", layerY);
            shelf.setAttribute("width", shelfWidth);
            shelf.setAttribute("height", shelfHeight - 10);
            shelfContainer.appendChild(shelf);

            // 绘制层名称
            const layerText = document.createElementNS("http://www.w3.org/2000/svg", "text");
            layerText.setAttribute("x", startX - 40);
            layerText.setAttribute("y", layerY + shelfHeight / 2);
            layerText.setAttribute("dominant-baseline", "middle");
            layerText.setAttribute("font-family", "Arial");
            layerText.setAttribute("font-size", "14");
            layerText.setAttribute("fill", "#333");
            layerText.textContent = layerName;
            shelfContainer.appendChild(layerText);

            // 绘制盒子
            const boxes = shelfData[layerName];
            const boxNames = Object.keys(boxes);

            boxNames.forEach((boxName, boxIndex) => {
                const boxData = boxes[boxName];
                const boxX = startX + boxIndex * (boxWidth + boxMargin) + boxMargin;
                const boxY = layerY + 10;

                // 创建盒子组
                const boxGroup = document.createElementNS("http://www.w3.org/2000/svg", "g");
                boxGroup.setAttribute("class", "box-group");
                boxGroup.setAttribute("data-layer", layerName);
                boxGroup.setAttribute("data-box", boxName);

                if (boxData.is_show) {
                    // 绘制盒子
                    const box = document.createElementNS("http://www.w3.org/2000/svg", "rect");
                    box.setAttribute("class", boxData.status ? "box-closed" : "box-opened");
                    box.setAttribute("x", boxX);
                    box.setAttribute("y", boxY);
                    box.setAttribute("width", boxWidth);
                    box.setAttribute("height", boxHeight);
                    box.setAttribute("rx", "5");
                    box.setAttribute("ry", "5");
                    boxGroup.appendChild(box);

                    // 盒子正面文字
                    const frontText = document.createElementNS("http://www.w3.org/2000/svg", "text");
                    frontText.setAttribute("class", "box-text");
                    frontText.setAttribute("x", boxX + boxWidth / 2);
                    frontText.setAttribute("y", boxY + boxHeight / 2 - 8);
                    frontText.textContent = boxData.str;
                    boxGroup.appendChild(frontText);

                    // 盒子状态文字
                    const statusText = document.createElementNS("http://www.w3.org/2000/svg", "text");
                    statusText.setAttribute("class", "box-text");
                    statusText.setAttribute("x", boxX + boxWidth / 2);
                    statusText.setAttribute("y", boxY + boxHeight / 2 + 8);
                    statusText.setAttribute("font-size", "10");
                    statusText.textContent = boxData.status_str;
                    boxGroup.appendChild(statusText);

                    // 添加点击事件
                    boxGroup.addEventListener('click', () => showModal(boxData));
                } else {
                    // 绘制空位
                    const empty = document.createElementNS("http://www.w3.org/2000/svg", "rect");
                    empty.setAttribute("class", "empty-space");
                    empty.setAttribute("x", boxX);
                    empty.setAttribute("y", boxY);
                    empty.setAttribute("width", boxWidth);
                    empty.setAttribute("height", boxHeight);
                    boxGroup.appendChild(empty);
                }

                shelfContainer.appendChild(boxGroup);
            });
        });
    }

    // 显示弹窗
    function showModal(boxData) {
        const modal = document.getElementById('modal');
        const modalTitle = document.getElementById('modalTitle');
        const modalContent = document.getElementById('modalContent');
        const modalImage = document.getElementById('modalImage');

        modalTitle.textContent = boxData.title;
        modalContent.textContent = boxData.content;
        modalImage.setAttribute("href", boxData.img);
        modalImage.setAttribute("alt", boxData.title);

        modal.classList.remove('hidden');
    }

    // 关闭弹窗
    function closeModal() {
        const modal = document.getElementById('modal');
        modal.classList.add('hidden');
    }

    // 切换盒子动画
    let isAnimating = false;
    function toggleAnimation() {
        const boxes = document.querySelectorAll('.box-closed, .box-opened');
        const animation = document.getElementById('boxBounce');

        if (isAnimating) {
            boxes.forEach(box => {
                box.removeAttribute('transform');
                box.removeAttribute('data-animating');
            });
            animation.endElement();
        } else {
            boxes.forEach(box => {
                const clone = animation.cloneNode(true);
                box.appendChild(clone);
                clone.beginElement();
                box.setAttribute('data-animating', 'true');
            });
        }

        isAnimating = !isAnimating;
    }

    // 初始化事件监听
    function initEvents() {
        document.getElementById('closeButton').addEventListener('click', closeModal);
        document.getElementById('animateButton').addEventListener('click', toggleAnimation);
    }

    // 初始化
    renderShelf();
    initEvents();
    ]]></script>
</svg>
